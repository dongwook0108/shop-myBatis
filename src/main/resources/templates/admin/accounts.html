<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{admin/fragments.html::header}"></head>

<body class="bg03">
<div class="container">
    <div class="row">
        <div class="col-12">
            <nav th:replace="~{admin/fragments.html::nav-accounts}"
                 class="navbar navbar-expand-xl navbar-light bg-light">

            </nav>
        </div>
    </div>

    <!-- row -->
    <div class="row tm-content-row tm-mt-big">
        <div class="tm-col tm-col-big">
            <div class="bg-white tm-block">
                <div class="row">
                    <div class="col-12">
                        <h2 style="padding: 5px" class="tm-block-title d-inline-block">회원 목록</h2>
                        <div style="padding: 2px; margin-bottom: 20px">
                            <form th:action="@{/admin/members}" method="get">
                                <label for="email"></label>
                                <label for="emailSearch"></label><input type="text" id="emailSearch"
                                                                        name="email"
                                                                        placeholder="Search Eamil">
                                <button type="submit" style="border-radius: 5px">검색하기</button>
                            </form>
                        </div>

                    </div>
                </div>
                <ul class="tm-list-group tm-list-group-alternate-color tm-list-group-pad-big">
                    <th:block th:if="${memberList.isEmpty()}">
                        <p>결과가 없습니다.</p>
                    </th:block>
                    <th:block th:unless="${memberList.isEmpty()}">
                        <li class="tm-list-group-item" th:each="member : ${memberList}">
                            <a th:member-id="${member.id}"
                               th:onclick="requestMemberDetail(this.getAttribute('member-id'))"
                               th:text="${member.email}">user
                                email</a>
                        </li>
                    </th:block>


                </ul>
                <div id="pagination">
                    <!-- 맨 처음 페이지로 이동하는 버튼 -->
                    <span th:if="${pageVo.startPage > 1}">
                        <a th:href="@{'/admin/members?page=1'}" th:text="'처음&emsp;'"></a>
                    </span>

                    <!-- 이전 블록으로 이동하는 버튼 -->
                    <span th:if="${pageVo.isPrev == true}">
                    	<a th:href="@{'/admin/members?page='+${pageVo.startPage - 1}}"
                           th:text="'이전'"></a>
                    </span>

                    <!-- 시퀀스 보여주는 값을 변경. -->
                    <span th:each="pageNum : ${#numbers.sequence(pageVo.startPage, pageVo.endPage)}">
                        <a class="div2" th:href="@{'/admin/members?page='+${pageNum}}"
                           th:text="|&emsp;${pageNum}&emsp;|"></a>
                    </span>

                    <!-- 다음 블록으로 이동하는 버튼 -->
                    <span th:if="${pageVo.isNext == true}">
                	<a th:href="@{'/admin/members?page='+ ${pageVo.endPage + 1}}"
                       th:text="'다음'"></a>
                    </span>

                    <!-- 맨 뒷 페이지로 이동하는 버튼 -->
                    <span th:if="${pageVo.endPage < pageVo.totalPageCount}">
                	<a th:href="@{'/admin/members?page='+${pageVo.totalPageCount}}"
                       th:text="|&emsp;끝|"></a>
                    </span>
                </div>


                <ul class="tm-list-group tm-list-group-alternate-color tm-list-group-pad-big">
                </ul>
            </div>
        </div>

        <div class="tm-col tm-col-big" style="display: none" id="detail-page">
            <div class="bg-white tm-block">
                <div class="row">
                    <div class="col-12">
                        <h2 class="tm-block-title">회원 수정</h2>
                    </div>
                </div>
                <div class="row">
                    <div class="col-12">
                        <form action="" class="tm-signup-form">
                            <div class="form-group">
                                <label for="name">이름</label>
                                <input placeholder="Vulputate Eleifend Nulla" id="name" name="name"
                                       type="text"
                                       class="form-control validate">
                            </div>
                            <div class="form-group">
                                <label for="email">이메일</label>
                                <input placeholder="vulputate@eleifend.co" id="email" name="email"
                                       type="email"
                                       class="form-control validate">
                            </div>
                            <div class="form-group">
                                <label for="phone">전화번호</label>
                                <input placeholder="010-030-0440" id="phone" name="phone" type="tel"
                                       class="form-control validate">
                            </div>
                            <div class="row">
                                <div class="col-12 col-sm-4">
                                    <button type="submit" class="btn btn-primary">수정
                                    </button>
                                </div>
                                <div class="col-12 col-sm-8 tm-btn-right">
                                    <button type="submit" class="btn btn-danger">삭제
                                    </button>
                                </div>
                            </div>

                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>


</div>

<script src="/js/jquery-3.3.1.min.js"></script>
<!-- https://jquery.com/download/ -->
<script src="/js/bootstrap.min.js"></script>
<!-- https://getbootstrap.com/ -->
<script>
    const memberName = document.querySelector("#name");
    const memberEmail = document.querySelector("#email");
    const memberPhone = document.querySelector("#phone");
    const detailPage = document.querySelector("#detail-page");

    function requestMemberDetail(memberId) {
        $.ajax("/api/member-detail?id=" + memberId)
        .done((data) => {
            detailPage.style.display = "block";
            memberName.value = data.username;
            memberEmail.value = data.email;
            memberPhone.value = data.phoneNumber;
        })
    }
</script>
</body>

</html>